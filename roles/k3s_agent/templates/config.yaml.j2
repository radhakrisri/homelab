# K3s Agent Configuration
# Generated by Ansible - Do not edit manually

server: "{{ k3s_server_url }}"
token: "{{ k3s_token }}"

# Node configuration
node-name: "{{ inventory_hostname }}"
{% if k3s_node_labels | length > 0 %}
node-label:
{% for label in k3s_node_labels %}
  - "{{ label }}"
{% endfor %}
{% endif %}

{% if k3s_node_taints | length > 0 %}
node-taint:
{% for taint in k3s_node_taints %}
  - "{{ taint }}"
{% endfor %}
{% endif %}

# Kubelet arguments
kubelet-arg:
  - "max-pods=110"
{% if ansible_architecture == 'aarch64' %}
  # ARM64 specific settings
  - "eviction-hard=memory.available<100Mi,nodefs.available<5%"
{% endif %}

{% if k3s_agent_extra_args %}
# Extra arguments
{{ k3s_agent_extra_args }}
{% endif %}
